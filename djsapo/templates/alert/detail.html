{% extends "home.html" %}
{% load humanize model_helpers %}
{% block extra_javascript %}
{{block.super}}
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.0/js/bootstrap-select.min.js"
  type="text/javascript" language="javascript"></script>
<script src="//www.carthage.edu/static/vendor/js/spin.min.js"
    type="text/javascript"></script>
<script src="https://malsup.github.io/min/jquery.blockUI.min.js"
    type="text/javascript"></script>
<script src="/static/djsapo/js/main.js"
  type="text/javascript" language="javascript"></script>
<script type="text/javascript" charset="utf-8">
$(function() {
  $('#print').click(function() {
    window.print();
    return false;
  });
  $('[data-toggle="tooltip"]').tooltip();
});
</script>
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-lg-12">
    <h2 class="page-header">
      <a href="mailto:{{data.student.email}}">
        {{data.student.last_name}}, {{data.student.first_name}}</a>
      {% if perms.team or perms.admin %}[{{data.student.id}}]{% endif %}
      <!--
      <a href="{# #}">
        <i class="fa fa-pencil-square-o" data-toggle="tooltip" data-placement="right"
          title="Update this Alert" aria-hidden="true"></i></a>
      -->
    </h2>
  </div>
  <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
  <div class="col-lg-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <dl class="dl-horizontal">
          <dt>Status</dt>
          <dd>
            <select name="status" class="list-group-item-success selectpicker set-val"
            data-width="300px" id="status" data-pk="{{data.id}}" data-style="list-group-item-success text-dark"
            title="Choose status&hellip;">
            {% for s in data.STATUS_CHOICES %}
            <option value="{{s.0}}"{% if s.0 == data.status %} selected="selected"{% endif %}>
            {{s.1|safe}}
            </option>
            {% endfor %}
            </select>
          </dd>
          {% if data.course %}
          <dt>Course</dt>
          <dd>{{data.course}}</dd>
          {% endif %}
          <dt>Relationship with student</dt>
          <dd>{{data.relationship}}</dd>
          <dt>
          Type of concern
          <a href="{# url 'category' alert.id #}" class="no-print-icon">
            <i class="fa fa-tags fa-5 green blue-tooltip" aria-hidden="true" data-toggle="tooltip" data-placement="top"
            title="Add a type of concern to this alert"></i></a>
          </dt>
          <dd>
            <ul class="list-group mb-3">
            {% for c in data.category.all %}
            <li class="list-group-item text-dark {% autoescape off %}{% cycle 'list-group-item-light' 'list-group-item-none' %}{% endautoescape %}">
            {{c}}
            </li>
            {% endfor %}
            </ul>
          </dd>
          <dt>Details about this concern</dt>
          <dd>
            <div class="card bg-light">
              <div class="card-body">
                <div class="card-text">{{data.description|safe}}</div>
              </div>
            </div>
          </dd>
        </dl>
        <div class="card bg-light mb-3">
          <div class="card-body">
          <dl class="dl-horizontal">
          <dt>Have you interacted with the student regarding this concern?</dt>
          <dd>
            {{data.interaction}}
          </dd>
          {% if data.interaction == 'Yes' %}
            <dt>How did you interact with this student?</dt>
            <dd>{{data.interaction_type}}</dd>
            <dt>Date of interaction</dt>
            <dd>{{data.interaction_date}}</dd>
            <dt>Interaction details</dt>
            <dd>
              <div class="card bg-light">
                <div class="card-body">
                  <div class="card-text">{{data.interaction_details|safe}}</div>
                </div>
              </div>
            </dd>
          {% endif %}
          <dt>Outcome</dt>
          <dd>{{data.outcome}}</dd>
          </dl>
          </div>
        </div>
        <h4>Documents <i class="fa fa-floppy-o green" aria-hidden="true"></i></h4>
        <ul class="list-group mb-3">
          {% for d in data.documents.all %}
            {% if d.phile %}
            <li class="list-group-item {% autoescape off %}{% cycle 'list-group-item-light' 'list-group-item-none' %}{% endautoescape %}">
              <h5>
                <a href="https://{{server_url}}{{media_url}}{{d.phile}}">{% if d.name %}{{d.name}}{% else %}{{d.created_at}}{% endif %}</a>
                <i class="fa fa-file-{{d.get_icon}}-o green" aria-hidden="true"></i>
              </h5>
            </li>
            {% endif %}
          {% endfor %}
        </ul>
        <!-- fin -->
      </div>
      <!-- /.panel-body -->
    </div>
    <!-- /.panel -->
  </div>
  <!-- /.col-lg-6 -->
  <div class="col-lg-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <h4>
          Team members
          <a href="{# url 'member' alert.id #}" class="no-print-icon">
            <i class="fa fa-users green blue-tooltip" aria-hidden="true" data-toggle="tooltip" data-placement="bottom"
            title="Add Team Member to this Alert"></i></a> |
          <a href="{# url 'email_team_form' alert.id #}" class="no-print-icon">
            <i class="fa fa-envelope green blue-tooltip" aria-hidden="true"
            data-toggle="tooltip" data-placement="top"
            title="Send Email to the Alert Team"></i></a>
        </h4>
        <ul class="list-group mb-3">
        {% for m in data.team.all %}
        <li class="list-group-item {% autoescape off %}{% cycle 'list-group-item-light' 'list-group-item-none' %}{% endautoescape %}">
          <span{% if not m.status %} class="strike"{% endif %}>
            <span>
                {% if m.status %}
                <a href="{# url remove_member #}" class="no-print-icon">
                <i class="fa fa-times red blue-tooltip" data-toggle="tooltip" data-placement="top"
                  title="Remove from the alert team" aria-hidden="true"></i>
                {% else %}
                <i class="fa fa-ban red" data-toggle="tooltip" data-placement="top"
                  title="No longer a member of the alert team" aria-hidden="true"></i>
                {% endif %}
                <a href="mailto:{{m.user.email}}"{% if not m.status %} title="No longer a member of the team"{% endif %}>{{m}}</a>
                {% if m.case_manager %}
                <i class="fa fa-star green blue-tooltip" data-toggle="tooltip"
                  data-placement="top" title="Case Manager" aria-hidden="true"></i>
                {% endif %}
            </span>
          </span>
        </li>
        {% endfor %}
        </ul>
        <h4>
          Comments
          <a href="{# url 'comment_form' alert.id #}" class="no-print-icon">
            <i class="fa fa-comments-o green blue-tooltip" data-toggle="tooltip"
            data-placement="top" title="Submit a comment" aria-hidden="true"></i></a>
        </h4>
        {% for n in data.notes.all %}
        {% if n.status %}
        <div class="card mb-3 {% autoescape off %}{% cycle 'list-group-item-warning' 'list-group-item-info' %}{% endautoescape %}">
          <div class="card-body">
            <h5 class="card-title mb-2">
              <a href="mailto:{{n.created_by.email}}">
                {{n.created_by.last_name}}, {{n.created_by.first_name}}</a>
            </h5>
            <h6 class="card-subtitle mb-2 text-muted">{{n.created_at}}</h6>
            <div class="card-text text-dark">{{n.body|safe}}</div>
          </div>
        </div>
        {% endif %}
        {% endfor %}
        <!-- fin -->
      </div>
      <!-- /.panel-body -->
    </div>
    <!-- /.panel -->
  </div>
  <!-- /.col-lg-6 -->
</div>
<!-- /.row -->
{% endblock content %}
