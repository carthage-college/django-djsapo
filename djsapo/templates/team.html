{% extends "datatables.html" %}
{% block extra_javascript %}
{{block.super}}
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-sortablejs@latest/jquery-sortable.js"></script>
<script>
// With options:
$('#matrix-table').sortable({
  invertSwap: true,
    group: {
        name: 'shared'
    },
    animation: 150,
    sort: false,
    onAdd: function (evt) {
        console.log(evt);
    },
    onRemove: function (evt) {
        console.log(evt);
    }
});
$('#team-members').sortable({
    group: 'shared',
    animation: 150,
    sort: false,
    filter: '.strike', // strike class is not draggable
    onAdd: function (evt) {
        console.log(evt);
    },
    onRemove: function (evt) {
        console.log(evt);
    }
})
</script>
{% endblock %}
{% block content %}
{% include "alert/student.header.inc.html" %}
<div class="container mb-4">
  <div class="row mb-3">
    <div class="col-lg-9">
      <h2>Alert Team Manager</h2>
      <p>
        Click on a person's name and drag the it from one side to the other.
        To add someone to the team, drag them from the left and drop them on the right.
        To remove someone from the team, drag them from the right to drop them on the left.
      </p>
    </div>
    <!-- /.col-lg-8 -->
  </div>
  <!-- /.row -->
  <div class="row mb-3">
    <div class="col-lg-6">
      <h4>SOS Matrix</h4>
      <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover display compact data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Groups</th>
            </tr>
          </thead>
          <tbody id="matrix-table">
            {% for m in matrix %}
            <tr>
              <td nowrap data-mid="{{m.id}}">
                <i class="fa fa-arrows handle"></i>
                {{m.last_name}}, {{m.first_name}}
              </td>
              <td nowrap>
                {% for g in m.groups.all %}
                {% if 'Status' not in g.name %}
                {{g}}{% if not forloop.last %}, {% endif %}
                {% endif %}
                {% endfor %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <!-- /.col-lg-6 -->
    <div class="col-lg-6">
      <h4>Current Team</h4>
      <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover display compact data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Groups</th>
            </tr>
          </thead>
          <tbody id="team-members">
            {% for m in data.team.all %}
            <tr{% if not  m.status %} class="strike"{% endif %}>
              <td nowrap data-mid="{{m.user.id}}">
                  <span>
                <i class="fa fa-arrows handle"></i>
                {{m.user.last_name}}, {{m.user.first_name}}
                  </span>
              </td>
              <td nowrap>
                <span>
                {% for g in m.user.groups.all %}
                {% if 'Status' not in g.name %}
                {{g.name}}{% if not forloop.last %}, {% endif %}
                {% endif %}
                {% endfor %}
                </span>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <!-- /.col-lg-6 -->
  </div>
  <!-- /.row -->
  <div class="row">
    <div class="col-lg-9">
      <h3>Ad Hoc Member</h3>
      <p>
        If you do not see the person in the lists above that you would like
        to add to the team, you can do so with the following form.
      </p>
    </div>
    <!-- /.col-lg-8 -->
  </div>
  <!-- /.row -->
  <div class="row">
    <div class="col-lg-6">
      <div class="panel">
        <div class="panel-body">
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /.panel -->
    </div>
    <!-- /.col-lg-6 -->
  </div>
  <!-- /.row -->
</div>
<!-- /.container -->
{% endblock content %}
